<!DOCTYPE html>
<html lang="en">
    <link rel="stylesheet" href= "/css/style.css" | absURL }}>
    
    <head><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
<h1 id="title">Jordan Herzstein <a onclick="switchTheme()" title="toggle theme" id="toggle-theme">
      <svg width="30" height="30" class="light" id="light-icon">
        <circle cx="15" cy="15" r="6" fill="currentColor" />

        <line
          id="ray"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          x1="15"
          y1="1"
          x2="15"
          y2="4"
        ></line>

        <use href="#ray" transform="rotate(45 15 15)" />
        <use href="#ray" transform="rotate(90 15 15)" />
        <use href="#ray" transform="rotate(135 15 15)" />
        <use href="#ray" transform="rotate(180 15 15)" />
        <use href="#ray" transform="rotate(225 15 15)" />
        <use href="#ray" transform="rotate(270 15 15)" />
        <use href="#ray" transform="rotate(315 15 15)" />
      </svg>
      <svg width="30" height="30" class="dark" id="dark-icon">
        <path
          fill="currentColor"
          d="
          M 23, 5
          A 12 12 0 1 0 23, 25
          A 12 12 0 0 1 23, 5"
        />
      </svg>
 </a></h1><title>Jordan Herzstein</title> 

<head>
</head>
    <header><div class="menubar">
  <div class="menu-container">
      <a href="/">home</a>
      -
      <a href="/about">about</a>
      -
      <a href="/posts">posts</a>
      -
      <a href="/mysetup">setup</a>
      -
      <a href="/contact">contact</a>
      
<script>
</script>
      <script>
	const lightIcon = document.getElementById("light-icon");
	const darkIcon = document.getElementById("dark-icon");
	var i = "theme";
	var d = document.documentElement.classList;
	
	var m = localStorage.getItem(i) || (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches ? "light" : "dark");
	
	if (m == "light") {
	    d.remove("dark");
	    d.add(m);
	    lightIcon.setAttribute("display", "none");
	    darkIcon.setAttribute("display", "block");
	} else {
	    d.remove("light");
	    d.add(m);
	    lightIcon.setAttribute("display", "block");
	    darkIcon.setAttribute("display", "none");
	}
	
	function switchTheme() {
	    d.remove(m);
	    m = (m == "dark") ? "light" : "dark";
	    d.add(m);
	    localStorage.setItem(i, m);
	    if (m == "light") {
		lightIcon.setAttribute("display", "none");
		darkIcon.setAttribute("display", "block");
	    } else {
		lightIcon.setAttribute("display", "block");
		darkIcon.setAttribute("display", "none");
	    }
	}
	
	
	window.matchMedia('(prefers-color-scheme: light)').addEventListener('change', e => {
	    const newColorScheme = e.matches ? "light" : "dark";
	    if (newColorScheme !== m) {
		switchTheme();
	    }
	});

      </script>
      
  </div>
</div>




</header>

    <body>
        <div class="page">


            <section class="page__body">
    <header class="content__header">
        <h1>Overengineering Waking Up: ESPHome RGB Lightbulb in Home Assistant</h1>
    </header>

    
    
    <svg aria-hidden="true" class="hi-svg-inline" fill="none" height="1.0em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1.0em" xmlns="http://www.w3.org/2000/svg">
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
  <line x1="16" y1="2" x2="16" y2="6" />
  <line x1="8" y1="2" x2="8" y2="6" />
  <line x1="3" y1="10" x2="21" y2="10" />
</svg>


      2025-08-13 |
    
    
    
    <svg aria-hidden="true" class="hi-svg-inline" fill="none" height="1.0em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1.0em" xmlns="http://www.w3.org/2000/svg">
  <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
  <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
</svg>

    
        2025-08-13
     |
    
    

    <svg aria-hidden="true" class="hi-svg-inline" fill="none" height="1.0em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1.0em" xmlns="http://www.w3.org/2000/svg">
  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
  <polyline points="14 2 14 8 20 8" />
  <line x1="16" y1="13" x2="8" y2="13" />
  <line x1="16" y1="17" x2="8" y2="17" />
  <polyline points="10 9 9 9 8 9" />
</svg>


     540 words |

    


    <svg aria-hidden="true" class="hi-svg-inline" fill="none" height="1.0em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1.0em" xmlns="http://www.w3.org/2000/svg">
  <circle cx="12" cy="12" r="10" />
  <polyline points="12 6 12 12 16 14" />
</svg>

     3 min 


    <br><span class="tags-list"><span class="meta-item">

<svg aria-hidden="true" class="hi-svg-inline" fill="none" height="1.0em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="1.0em" xmlns="http://www.w3.org/2000/svg">
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z" />
  <line x1="7" y1="7" x2="7.01" y2="7" />
</svg>

<span class="tags">
                      <a href="/tags/technology/">#technology</a>
                  </span>
          <span class="tags">
                      <a href="/tags/tutorial/">#tutorial</a>
                  </span>
          <span class="tags">
                      <a href="/tags/home-assistant/">#home-assistant</a>
                  </span>
          </span></span>
<br><div class="ox-hugo-toc toc">
<div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#guide" aria-label="Guide">Guide</a><ul>
                        
                <li>
                    <a href="#athom-rgbct-light-start" aria-label="Athom RGBCT Light start">Athom RGBCT Light start</a></li>
                <li>
                    <a href="#setting-up-esphome-server" aria-label="Setting up ESPHome Server">Setting up ESPHome Server</a></li>
                <li>
                    <a href="#athom-light-configuration" aria-label="Athom Light Configuration">Athom Light Configuration</a></li>
                <li>
                    <a href="#esphome-home-assistant-integration" aria-label="ESPHome Home Assistant Integration">ESPHome Home Assistant Integration</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>
</div>
<div class="content__body">
         <p>I used to have one of those sunrise alarm clocks in high school, I mainly stopped using it because micro-usb port for powering it was pretty flimsy and would fall out constantly. However, I still want to have something similar so instead of getting a new one like a normal person I decided to overengineer my own alarm clock with a wifi RGB LED lightbulb. Using that I made an <a href="https://github.com/jherzstein/ha_exponential_sunrise_alarm">automation blueprint</a> to tie it all together, which I&rsquo;ve been using since May and you are free to use for yourself.</p>
<h2 id="guide">Guide</h2>
<p>For this guide assumes that you have the following prerequesites:</p>
<ul>
<li>Athom Technology <a href="https://www.athom.tech/blank-1/e14-color-bulb-for-esphome">E14 Color Bulb for ESPHome</a></li>
<li>A device running Home Assistant core</li>
<li>Docker compose</li>
</ul>
<h3 id="athom-rgbct-light-start">Athom RGBCT Light start</h3>
<ul>
<li>Power on Athom Light</li>
<li>Connect to Athom Light AP</li>
<li>Go to 192.168.4.1</li>
<li>Put in 2.4GHz wifi SSID and password</li>
<li>Take note of the domain, it should be automatically assigned to something like <a href="http://athom-rgbct-light-xxxxxx.lan/">http://athom-rgbct-light-xxxxxx.lan/</a>. I suggest going into your router or whatever you have managing dns and dhcp and setting up a route so that the ip and mac address of the Athom light bulb always uses that domain.</li>
</ul>
<h3 id="setting-up-esphome-server">Setting up ESPHome Server</h3>
<p>Put the following in <code>compose.yaml</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#39;3&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">esphome</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">esphome</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">esphome/esphome</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">./config:/config</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">/etc/localtime:/etc/localtime:ro</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">privileged</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">network_mode</span>: <span style="color:#ae81ff">host</span></span></span></code></pre></div>
<p>ESPHome should start on port 6052 by default, so make sure you have that port open on your machine&rsquo;s firewall. Then simply start up the container in the background with <code>docker compose up -d</code>. Open up your browser and you should start with the following:</p>
<center>
  <div style="max-width: 100%;" >
    <figure class="frame" style="max-width: 100%;">
      <img src="/images/blog/Screenshot_Dashboard-ESPHome.png"  />
    </figure>
  </div>
</center>
<h3 id="athom-light-configuration">Athom Light Configuration</h3>
<p>First, inside the folder you assigned for your <code>/config</code> docker volume for esphome server, fill out the following in <code>secrets.yaml</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#75715e"># Your Wi-Fi SSID and password</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">wifi_ssid</span>: <span style="color:#e6db74">&#34;IOT-WiFi-SSID&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">wifi_password</span>: <span style="color:#e6db74">&#34;Password&#34;</span></span></span></code></pre></div>
<p>Next, you can find athom&rsquo;s RGBCT light configurations on their github under <a href="https://github.com/athom-tech/athom-configs/blob/main/athom-rgbct-light.yaml">athom-rgbct-light.yaml</a>. Place this file in the configuration folder.</p>
<p>There are a few changes I&rsquo;ve made to the default configuration file for the athom light. Namely, I&rsquo;ve included my own 32-byte base64-encoded string as the api key which I define in the yaml file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">api</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">encryption</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">key</span>: <span style="color:#75715e"># Place 32-byte base64-encoded string for your api key</span></span></span></code></pre></div>
<p>I also like to put my IOT devices on a separate hidden wifi network isolated from my other devices, so I put in the configuraiton to search for wifi networks with hidden SSIDs and put in our secrets from earlier as well.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#f92672">wifi</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">networks</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">hidden</span>: <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">ssid</span>: !<span style="color:#ae81ff">secret wifi_ssid</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">password</span>: !<span style="color:#ae81ff">secret wifi_password</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">domain</span>: <span style="color:#e6db74">&#34;${dns_domain}&#34;</span>
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div>
<p>Next you can compile and install. You also have the option of grabbing your API key here from the UI as we definined in the configuration yaml file.</p>
<center>
  <div style="max-width: 100%;" >
    <figure class="frame" style="max-width: 100%;">
      <img src="/images/blog/Screenshot_Dashboard-ESPHome_Install.png"  />
    </figure>
  </div>
</center>
<p>If you put in the domain of the athom light correctly, you can install the update wirelessly through ESPHome.</p>
<center>
  <div style="max-width: 100%;" >
    <figure class="frame" style="max-width: 100%;">
      <img src="/images/blog/Screenshot_Dashboard-ESPHome_Wireless_OTA_Install.png"  />
    </figure>
  </div>
</center>
<h3 id="esphome-home-assistant-integration">ESPHome Home Assistant Integration</h3>
<p>From Home assistant go into <strong><strong>Settings &gt; Devices &amp; services &gt; Add Integration</strong></strong>. Enter &ldquo;ESPHome&rdquo; into the search bar for an ESPHome integration.</p>
<center>
  <div style="max-width: 100%;" >
    <figure class="frame" style="max-width: 100%;">
      <img src="/images/blog/Screenshot_HA_Add_ESPHome_Integration.png"  />
    </figure>
  </div>
</center>
<p>From there select ESPHome as your integration, then enter the hostname/ip address and port for your api (default 6053).</p>
<center>
  <div style="max-width: 100%;" >
    <figure class="frame" style="max-width: 100%;">
      <img src="/images/blog/Screenshot_HA_Enter_RGB_Lightbulb_IP.png"  />
    </figure>
  </div>
</center>
<p>Then enter in the encryption key we defined in our athom light yaml configuration.</p>
<center>
  <div style="max-width: 100%;" >
    <figure class="frame" style="max-width: 100%;">
      <img src="/images/blog/Screenshot_HA_Enter_RGB_Lightbulb_API.png"  />
    </figure>
  </div>
</center>
<p>That&rsquo;s it, you&rsquo;ve now set up an RGB lightbulb running ESPHome in Home Assistant!</p>

    </div>
    <div class="next-post">
      
      <a class="link-reverse" href="/posts/icloud_to_immich_migration/">« Next Post: iCloud to Immich Migration...</a>
      
    </div>
    
    <div class="previous-post">
      
      <a class="link-reverse" href="/posts/git_cherry_pick_cheat_sheet/">Previous Post: Git Cherry Pick Cheat Sheet »</a>
      
    </div>

            </section>


            <footer class="page__footer"><div class="footer">
<hr style="width:100%;height:1px;border-width:0;color:gray;background-color:gray">
  <style>
    .footer{text-align: center;}
  </style>
  <div class="link-buttons-group">
    <span class="link-buttons">
      <a href="https://neocities.org">
        <img src="/images/link-buttons/neocitiesorg.gif"></a>
    </span>
    <span class="link-buttons">
      <a href="https://wiby.org">
        <img src="/images/link-buttons/wiby.org.gif"></a>
    </span>


    <span class="link-buttons">
      <a href="https://www.gnu.org/software/emacs/">
        <img src="/images/link-buttons/gnu-emacs.gif"></a>
    </span> 
    <span class="link-buttons">
      <a href="https://canada.ca">
        <img src="/images/link-buttons/sherri_coutts_canadaonweb.gif"></a>
        
    </span>
    <span class="link-buttons">
      <a href="https://creativecommons.org/licenses/by-sa/4.0/">
        <img src="/images/link-buttons/by-sa.png"></a>
    </span>
    <span class="link-buttons">
      <a href="https://www.gnu.org/licenses/gpl-3.0.en.html">
        <img src="/images/link-buttons/gplv3-88x31.png"></a>
    </span>
    <span class="link-buttons" >
	<a href="https://notbyai.fyi">
          <img id="light-icon" height="31" src="/images/link-buttons/Written-By-Human-Not-By-AI-Badge-white.png"></a>
	<a href="https://notbyai.fyi">
          <img id="dark-icon" height="31" src="/images/link-buttons/Written-By-Human-Not-By-AI-Badge-black.png"></a>
    </span>
  </div>
  <div class= "copyright">
    © 2025 <a href="/">Jordan Herzstein</a>, content <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>, code <a href="https://www.gnu.org/licenses/gpl-3.0.en.html">GPLv3</a>, exported using <a href="https://www.gnu.org/software/emacs/">Emacs</a> + <a href="https://orgmode.org">Org Mode</a> + <a href="https://ox-hugo.scripter.co/">ox-hugo</a>, published with <a href="https://gohugo.io">Hugo</a>
    <br>
    
  </div>
       
</div>
</footer>

        </div>
    </body>

</html>
